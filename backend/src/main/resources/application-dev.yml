spring:
  datasource:
    # App Runner-friendly:
    # Prefer Spring standard env vars if set, otherwise fall back to your DB_* vars,
    # otherwise fall back to localhost for local dev.
    url: ${SPRING_DATASOURCE_URL:${DB_URL:jdbc:postgresql://localhost:5432/montron_pm}}
    username: ${SPRING_DATASOURCE_USERNAME:${DB_USER:montron_pm}}
    password: ${SPRING_DATASOURCE_PASSWORD:${DB_PASS:montron_pm}}

    hikari:
      # Smaller defaults for testing/App Runner to avoid unnecessary load/cost.
      # Override anytime via env vars if you need:
      maximum-pool-size: ${DB_POOL_MAX:5}
      minimum-idle: ${DB_POOL_MIN_IDLE:1}
      connection-timeout: ${DB_POOL_CONN_TIMEOUT_MS:30000}
      idle-timeout: ${DB_POOL_IDLE_TIMEOUT_MS:600000}
      max-lifetime: ${DB_POOL_MAX_LIFETIME_MS:1800000}

  jpa:
    show-sql: ${JPA_SHOW_SQL:true}
    properties:
      hibernate:
        format_sql: ${HIBERNATE_FORMAT_SQL:true}

server:
  # App Runner compatible
  port: ${SERVER_PORT:8080}

security:
  cors:
    # Make App Runner/Amplify testing easy
    origins: ${SEC_CORS_ORIGINS:http://localhost:3000,http://localhost:3001}

logging:
  level:
    dev.montron.pm: DEBUG
    org.springframework.web: DEBUG
    org.hibernate.SQL: DEBUG

form-api:
  base-url: ${FORM_API_BASE_URL:http://localhost:8090/api}
  # Service token for service-to-service communication (recommended)
  service-token: ${FORM_API_SERVICE_TOKEN:}
  # Legacy technical token (deprecated, use service-token instead)
  technical-token: ${FORM_API_TECHNICAL_TOKEN:}

pm:
  export:
    base-directory: ${PM_EXPORT_BASE_DIR:/tmp/montron-export}
